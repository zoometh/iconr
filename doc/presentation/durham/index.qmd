---
title: "Analysis of Prehistoric Iconography with the R package ***iconr***"
subtitle: "*Digital Archaeology* seminar<br>28<sup>th</sup> November 2022, University of Durham"
author: "Thomas Huet, Jose Pozo, Craig Alexander"
format:
  revealjs: 
    slide-number: true
    chalkboard: true
    scrollable: true
    preview-links: true
    citation-location: margin
    citations-hover: true
    reference-location: margin
    logo: images/inst-uni-oxford_.png
    css: styles.css
    footer: "The R package ***iconr*** - Thomas Huet, Jose Pozo, Craig Alexander - <https://github.com/zoometh/iconr>"
---

## {}

```{r}
#| echo: false
#| warning: false

library(iconr)
library(igraph)
library(dplyr)
library(sf)

dataDir <- system.file("extdata", package = "iconr")
imgs_path <- paste0(dataDir, "/imgs.csv")
imgs <- read.table(imgs_path, sep = ";", stringsAsFactors = FALSE)
nodes_path <- paste0(dataDir, "/nodes.shp")
nodes.shp <- st_read(nodes_path, quiet = T)
nodes <- as.data.frame(nodes.shp)
edges_path <- paste0(dataDir, "/edges.shp")
edges.shp <- st_read(edges_path, quiet = T)
edges <- as.data.frame(edges.shp)
lgrph <- list_dec(imgs, nodes, edges)
```

This presentation is an introduction to **computational archaeology** 

<br>

<table>
<thead>
<tr>
<th rowspan="2">software üíø</th>
<th>semantic üñº üìú üî¢</th>
</tr>
<tr>
<th>logic <span style="background-color:black; color:white;">>_ print('hello')</span></th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="2">hardware üíª</td>
</tr>
</tbody>
</table>

  
  
It is also about ancient iconography<br>

<center>

![Tanum outcrop, Scandinavia (credits: Wikipedia)](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/ex-tanum-wiki.jpg){width=50%}

</center>

It introduces the R package ***iconr*** <a href="https://github.com/zoometh/iconr"><img src="https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/iconr_logo.png" alt="" style="height: 50px;margin: 0 0 0 0; background: transparent;" class="demo-logo"></a> and gives example of study with this package<br>

<center>

![Magacela stelae, Spain (credits: Wikipedia)](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/ex-magacela-wiki.jpg){width=30%}

</center>

# Computational archaeology {background-color="aquamarine"}

## {}

<th><a href="https://www.r-project.org/">
<img src="https://www.r-project.org/logo/Rlogo.svg" alt="" style="height: 100px; margin: 0 0 0 0; background: transparent;" class="demo-logo">
</a></th>

::: {.panel-tabset}

### Users

R is a scripting language for data science. It is the 1Ô∏è‚É£<sup>st</sup> used by archaeologists, and the 18<sup>th</sup> worldwide</p><small>- [Tiobe index 2022](https://www.tiobe.com/tiobe-index/) + [Batist and Roe, 2022](https://youtu.be/tUhHhzGSgbk?t=7499)</small>


### IDE

[RStudio](https://www.rstudio.com/) is THE graphical interface for R, Rstudio is also in the cloud ([RStudio.cloud](https://rstudio.cloud/)), [VS Code](https://code.visualstudio.com/) is a standalone source code editor multi-platforms and multi-languages

### Layouts

[R markdown](https://rmarkdown.rstudio.com/) is a notebook interface for report generation, [Shiny](https://shiny.rstudio.com/) allows the development of web interactive applications, [Quarto](https://quarto.org/) to create Powerpoint-like web interactive documents

### Packages

The [CRAN](https://cran.r-project.org/web/packages/) features 18,890 available packages. The package ***iconr*** uses 18 packages. The most distinctives are:

<table>
<thead>
<tr>
<th>package</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="https://raw.githubusercontent.com/zoometh/thomashuet/master/img/r-pkg-magick.png" width='150px' /></td>
<td>[magick](https://github.com/ropensci/magick) for image manipulation </td>
</tr>
<tr>
<td><img src="https://raw.githubusercontent.com/zoometh/thomashuet/master/img/r-pkg-igraph.png" width='150px' /></td>
<td>[igraph](https://igraph.org/r/) for graph theory and network analysis </td>
</tr>
<tr>
<td><img src="https://raw.githubusercontent.com/zoometh/thomashuet/master/img/r-pkg-sf.png" width='150px' /></td>
<td>[sf](https://cran.r-project.org/web/packages/sf/index.html) makes R a GIS </td>
</tr>
<tr>
<td><img src="https://raw.githubusercontent.com/zoometh/thomashuet/master/img/r-pkg-momocs.png" width='150px' /></td>
<td>[Momocs](https://cran.r-project.org/web/packages/Momocs/index.html) for geometric morphometric methods</td>
</tr>
</tbody>
</table>


### Resources

[sthda.com](http://www.sthda.com/english/wiki/ggplot2-line-plot-quick-start-guide-r-software-and-data-visualization) has good tutorials, [stackoverflow](https://stackoverflow.com/) is probably the place where you will find the answer you need, if you need some open software for archaeology go to [open-archaeo](https://open-archaeo.info/)

:::

## Computer stack

<a href="https://github.com">
<img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" alt="" style="height: 100px;margin: 0 0 0 0; background: transparent;" class="demo-logo">
</a>
The üîù popular web-platform for source code management and software development (with over 128 million public repositories)

<table>
<tbody>
  <tr>
    <td><a href="https://www.r-project.org/">
<img src="https://www.r-project.org/logo/Rlogo.svg" alt="" style="height: 100px; margin: 0 0 0 0; background: transparent;" class="demo-logo"></a></td>
  </tr>
  <tr>
    <td><a href="https://github.com">
<img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" alt="" style="height: 100px; margin: 0 0 0 0; background: transparent;" class="demo-logo">
</a></td>
  </tr>
</tbody>
</table>


# Ancient iconography {background-color="aquamarine"}


## <span style="color:white;">Nature of iconographic data</span> {background-iframe="https://zoometh.github.io/3DHOP/minimal/cogul.html" background-interactive="true"}

::: footer
Dataset: Roca dels Moros, Lleida, Catalunya. [3D model from the Generalitat de Catalunya](https://patrimoni.gencat.cat/ca/monuments/monumentos/conjunt-rupestre-de-la-roca-dels-moros-el-cogul/visita-virtual/visita-lliure/)
:::

## Aspectivity & Analogism

<center>

![Some warrior chariots (credits: https://www.adiantegalicia.es)](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/ex-warrior-chariot.jpg){width=700%}

</center>

* Aspectivity[^1]
* Analogism[^2]

[^1]: Francfort, H.-P., Huth, C., Olmos, R., Szab√≥, M., & Verger, S. (2010). "Qu‚Äôest-ce que l‚Äôart protohistorique ?" *Perspective*. Actualit√© en histoire de l‚Äôart, (2), 195‚Äì214
[^2]: Descola, P. (2021). *Les formes du visible. Une anthropologie de la figuration*. Seuil.
[^3]: https://www.adiantegalicia.es/reportaxes/2018/11/08/un-proyecto-identifica-vinculos-de-la-edad-de-bronce-entre-galicia-y-escandinavia.html

## Statement of need {auto-animate=true}


:::: {.columns}

::: {.column width="40%"}

![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/statement-need-support-loc.png)

:::

::: {.column width="60%"}

* Spatial proximities between the graphic units are not precisely quantified. Graphical units are attached to sub-areas of the support

:::

::::


## Statement of need {auto-animate=true}


:::: {.columns}

::: {.column width="40%"}

![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/statement-need-grouping.png)
![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/statement-need-support-loc.png)

:::

::: {.column width="60%"}

* Groupings are not self-explanatory and introduce a tedious number of groups and hinder their systematic analysis
* Spatial proximities between the graphic units are not precisely quantified. Graphical units are attached to sub-areas of the support

:::

::::


## Statement of need {auto-animate=true}


:::: {.columns}

::: {.column width="40%"}

![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/statement-need-gu-distances.png)
![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/statement-need-grouping.png)
![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/statement-need-support-loc.png)

:::

::: {.column width="60%"}

* Relationships and similarities between these groups are often not self-explanatory and unquantified
* Groupings are not self-explanatory and introduce a tedious number of groups and hinder their systematic analysis
* Spatial proximities between the graphic units are not precisely quantified. Graphical units are attached to sub-areas of the support

:::

::::

## Statement of need {auto-animate=true}

:::: {.columns}

::: {.column width="40%"}

![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/statement-need-vocabulary.png)
![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/statement-need-gu-distances.png)
![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/statement-need-grouping.png)
![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/statement-need-support-loc.png)


:::

::: {.column width="60%"}

* Descriptive vocabularies and methods of analysis are site-dependent or period dependent
* Relationships and similarities between these groups are often not self-explanatory and unquantified
* Groupings are not self-explanatory and introduce a tedious number of groups and hinder their systematic analysis
* Spatial proximities between the graphic units are not precisely quantified. Graphical units are attached to sub-areas of the support

:::

::::

## Conceptual model {auto-animate=true}

:::: {.columns}

::: {.column width="40%"}

![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/workflow-solana-step1.png)

:::

::: {.column width="60%"}

* Some objects have a decoration

:::

::::

## Conceptual model {auto-animate=true}

:::: {.columns}

::: {.column width="40%"}

![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/workflow-solana-step2.png)
![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/workflow-solana-step1.png)

:::

::: {.column width="60%"}

* A decoration is composed of graphical units (GUs)
* Some objects have a decoration

:::

::::



## Conceptual model {auto-animate=true}

:::: {.columns}

::: {.column width="40%"}

![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/workflow-solana-step3.png)
![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/workflow-solana-step1.png)
![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/workflow-solana-step2.png)

:::

::: {.column width="60%"}

* GUs can be modeled as POINTS or drawn as LINES or POLYGONS (2D)
* A decoration is composed of graphical units (GUs)
* Some objects have a decoration

:::

::::

## Conceptual model {auto-animate=true}

:::: {.columns}

::: {.column width="40%"}

![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/workflow-solana-step4.png)
![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/workflow-solana-step3.png)
![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/workflow-solana-step1.png)
![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/workflow-solana-step2.png)

:::

::: {.column width="60%"}

* Nodes have neighbourhood relations one with another depending on their spatial proximities (Voronoi Diagram);
* GUs are considered as nodes;
* GUs can be modeled as POINTS or drawn as LINES or POLYGONS (2D)
* A decoration is composed of graphical units (GUs)
* Some objects have a decoration

:::

::::

## Conceptual model {auto-animate=true}

:::: {.columns}

::: {.column width="40%"}

![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/workflow-solana-step5.png)
![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/workflow-solana-step4.png)
![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/workflow-solana-step3.png)
![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/workflow-solana-step1.png)
![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/workflow-solana-step2.png)

:::

::: {.column width="60%"}

* Shape analysis and hierachical thesaurus can measure the similarities between two GUs (eg. Procrustes distance);
* A decoration is considered as a spatial graph, modeled with graph theory and analysed with network and spatial analysis;
* Nodes have neighbourhood relations one with another depending on their spatial proximities (Voronoi Diagram);
* GUs are considered as nodes;
* GUs can be modeled as POINTS or drawn as LINES or POLYGONS (2D)
* A decoration is composed of graphical units (GUs)
* Some objects have a decoration


:::

::::


## Nodes {auto-animate=true}

**Main nodes**

:::: {.columns}

::: {.column width="40%"}

![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/cm1_type.png)

:::

::: {.column width="60%"}

Separated GUs showing different graphical contents (anthropomorphic figure, spear, shield, comb and ingot)

:::

::::

## Nodes {auto-animate=true}

**Main nodes**

```{r out.width = "100%"}
#| echo: false

par(mar = c(0,0,0,0))
g <- graph_from_literal(objects-+weapons,
                        objects-+personnal_item,
                        weapons-+offensive_weapons,
                        weapons-+defensive_weapons,
                        offensive_weapons-+spear,
                        offensive_weapons-+sword,
                        defensive_weapons-+shield,
                        defensive_weapons-+helmet,
                        personnal_item-+miror,
                        personnal_item-+comb)
layout <- layout.reingold.tilford(g)
plot(g,
     layout = layout,
     vertex.color = "white",
     vertex.frame.color = "white",
     vertex.size = 20,
     vertex.label.cex = 1,
     vertex.label.color = "black",
     vertex.label.family = "sans",
     edge.arrow.size = 0.5
     )
```


Hierarchical structure (tree) allowing comparison between decoration having different kinds of iconographic families and state of preservation: by generalisation (going up the tree) or by specification (going down the tree)

## Nodes {background-iframe="http://shinyserver.cfs.unipi.it:3838/teach/iconr/gu_thes/typo_gu_figuratif.html" background-interactive="true"}


## Nodes {auto-animate=true}

**Main nodes**

![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/gmm-brandherm-epees-draw-panel.png){width=40%}
![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/gmm-brandherm-epees-draw-stack.png){width=40%}

Shape analysis allows GUs of a given type to be compared and classified.


## Nodes {auto-animate=true}

**Attribute nodes**

:::: {.columns}

::: {.column width="60%"}

![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/cm1_type.png)

:::

::: {.column width="40%"}

Additional GUs characterising the main node (helmet, phalus)  

:::

::::


## Edges

::: {.panel-tabset}

### Normal

<span style="color:orange;"> ‚Äî‚Äî = ‚Äî‚Äî </span> normal edges (undirected) between contiguous and contemporaneous main nodes (nodes `a` and `b`)

```{r}
#| echo: false
#| warning: false

dataDir <- system.file("extdata", package = "iconr")
site <- "Brozas" 
decor <- "Brozas"
nds.df <- read_nds(site, decor, dataDir)
eds.df <- read_eds(site, decor, dataDir)
imgs_path <- paste0(dataDir, "/imgs.csv")
imgs <- read.table(imgs_path, sep = ";", stringsAsFactors = FALSE)
knitr::kable(eds.df, "html", align = "llcccrrrr") %>% 
  kableExtra::kable_styling(full_width = FALSE, position = "center", font_size = 24) %>%
  gsub("\\+", "+", .)
plot_dec_grph(nds.df, eds.df, imgs,
              site, decor, dataDir,
              ed.lwd = 1, ed.color = c("darkorange"),
              lbl.size = 0.7)
sort(named_elements(lgrph[[3]], focus = "edges", nd.var = "type"))
```

### Attribute

<span style="color:orange;"> - - + - - </span> attribute edges (directed) between contemporaneous nodes where the attribute node `b` is an attribute of main node `a`

```{r}
#| echo: false
#| warning: false

dataDir <- system.file("extdata", package = "iconr")
site <- "Zarza de Montanchez" 
decor <- "Zarza De Montanchez"
nds.df <- read_nds(site, decor, dataDir)
eds.df <- read_eds(site, decor, dataDir)
imgs_path <- paste0(dataDir, "/imgs.csv")
imgs <- read.table(imgs_path, sep = ";", stringsAsFactors = FALSE)
knitr::kable(eds.df, "html", align = "llcccrrrr", row.names = FALSE) %>% 
  kableExtra::kable_styling(full_width = FALSE, position = "center", font_size = 24)
plot_dec_grph(nds.df, eds.df, imgs,
              site, decor, dataDir,
              ed.lwd = 1, ed.color = c("darkorange"),
              lbl.size = 0.7)
sort(named_elements(lgrph[[4]], focus = "edges", nd.var = "type"))
```


### Diachronic

<span style="color:blue;"> ‚Äî‚Äî > ‚Äî‚Äî </span> diachronic edges (directed) between non-contemporaneous nodes where the node `a` overlaps node `b`, or node `a` is more ancient than node `b` 

```{r}
#| echo: false
#| warning: false

site <- "Ibahernando"
decor <- "Ibahernando"
nds.df <- read_nds(site, decor, dataDir)
eds.df <- read_eds(site, decor, dataDir)
imgs_path <- paste0(dataDir, "/imgs.csv")
imgs <- read.table(imgs_path, sep = ";", stringsAsFactors = FALSE)
knitr::kable(eds.df, "html", align = "llcccrrrr", row.names = FALSE) %>% 
  kableExtra::kable_styling(full_width = FALSE, position = "center", font_size = 24)
plot_dec_grph(nds.df, eds.df, imgs,
              site, decor, dataDir,
              lbl.size = 0.7)
sort(named_elements(lgrph[[5]], focus = "edges", nd.var = "type"))
```

:::

## GIS entry


::: {.panel-tabset}


### Reference

![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/gis_coordsQGIS.gif){width=70%}

### Scale


![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/gis_scaleAll.gif){width=70%}

QGIS plugin: [Freehand raster georeferencer](https://gvellut.github.io/FreehandRasterGeoreferencer/)

### Measures

![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/gis_scaleRuleOfThree.gif){width=70%}

### Nodes


![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/gis_createNodes.gif){width=70%}

### Edges


![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/gis_addEdges.gif){width=70%}

:::

## 1 project QGIS = 1 decoration

1. Open a decoration image

<center>

![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/gis_openImageGIS.gif){width=70%}

</center>

2. Create a spatialized graph

<center>

![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/gis_inputSummary.gif){width=70%}

</center>

## Run R

Install and load packages


```{r}
#| echo: true

# install.packages("iconr")
# install.packages("sf")
# install.packages("dplyr")
# install.packages("knitr")
# install.packages("kableExtra")

library(iconr)
library(igraph)
library(sf)
library(dplyr)
library(knitr)
library(kableExtra)
```

## Default data - images

::: {.panel-tabset}

### from R

```{r}
#| echo: true

dataDir <- system.file("extdata", package = "iconr")
imgs_path <- paste0(dataDir, "/imgs.csv")
imgs <- read.table(imgs_path, sep = ";", stringsAsFactors = FALSE)
kable(imgs, "html") %>% 
  kable_styling(full_width = FALSE, position = "center", font_size = 24)
```

<img src="https://raw.githubusercontent.com/zoometh/iconr/master/inst/extdata/Cerro_Muriano.Cerro_Muriano_1.jpg" width='200px' />
<img src="https://raw.githubusercontent.com/zoometh/iconr/master/inst/extdata/Torrejon_Rubio.Torrejon_Rubio_1.jpg" width='200px' />
<img src="https://raw.githubusercontent.com/zoometh/iconr/master/inst/extdata/Brozas.Brozas.jpg" width='200px' />
<img src="https://raw.githubusercontent.com/zoometh/iconr/master/inst/extdata/Zarza_de_Montanchez.Zarza_De_Montanchez.jpg" width='200px' />
<img src="https://raw.githubusercontent.com/zoometh/iconr/master/inst/extdata/Ibahernando.Ibahernando.jpg" width='200px' />

### data


<div>
<a href="https://github.com">
<img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" alt="" style="height: 50px;margin: 0 0 0 0; background: transparent;" class="demo-logo"></a>
<span class= smalltext><a href="https://github.com/zoometh/iconr/blob/master/inst/extdata/imgs.tsv">https://github.com/zoometh/iconr/blob/master/inst/extdata/imgs.tsv</a></span>
</div>

<script src="https://gist.github.com/zoometh/d00ed1575e69087efd7e006cc9cf00e5.js"></script>

<img src="C:/Users/Thomas Huet/Documents/R/win-library/4.1/iconr/extdata/Cerro_Muriano.Cerro_Muriano_1.jpg" alt="" style="height: 200px;margin: 0 0 0 0; background: transparent;" class="demo-logo"></a>
<img src="C:/Users/Thomas Huet/Documents/R/win-library/4.1/iconr/extdata/Torrejon_Rubio.Torrejon_Rubio_1.jpg" alt="" style="height: 200px;margin: 0 0 0 0; background: transparent;" class="demo-logo"></a>
<img src="C:/Users/Thomas Huet/Documents/R/win-library/4.1/iconr/extdata/Brozas.Brozas.jpg" alt="" style="height: 200px;margin: 0 0 0 0; background: transparent;" class="demo-logo"></a>
<img src="C:/Users/Thomas Huet/Documents/R/win-library/4.1/iconr/extdata/Zarza_de_Montanchez.Zarza_De_Montanchez.jpg" alt="" style="height: 200px;margin: 0 0 0 0; background: transparent;" class="demo-logo"></a>
<img src="C:/Users/Thomas Huet/Documents/R/win-library/4.1/iconr/extdata/Ibahernando.Ibahernando.jpg" alt="" style="height: 200px;margin: 0 0 0 0; background: transparent;" class="demo-logo"></a>

:::

## Default data - nodes

::: {.panel-tabset}

### from R

```{r}
#| echo: true

nodes_path <- paste0(dataDir, "/nodes.shp")
nodes.shp <- st_read(nodes_path, quiet = T)
nodes <- as.data.frame(nodes.shp)
kable(nodes, "html") %>% 
  kable_styling(full_width = FALSE, position = "center", font_size = 24)
```

### data

<div>
<a href="https://github.com">
<img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" alt="" style="height: 50px;margin: 0 0 0 0; background: transparent;" class="demo-logo"></a>
<span class= smalltext><a href="https://github.com/zoometh/iconr/blob/master/inst/extdata/nodes.tsv">https://github.com/zoometh/iconr/blob/master/inst/extdata/nodes.tsv</a></span>
</div>

<script src="https://gist.github.com/zoometh/6a91b544989db141d5a1a4b7b72ed123.js"></script>


:::

## Default data - edges

::: {.panel-tabset}

### from R

```{r}
#| echo: true

edges_path <- paste0(dataDir, "/edges.shp")
edges.shp <- st_read(edges_path, quiet = T)
edges <- as.data.frame(edges.shp)
kable(edges, "html") %>% 
  kable_styling(full_width = FALSE, position = "center", font_size = 24)
```

### data

<div>
<a href="https://github.com">
<img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" alt="" style="height: 50px;margin: 0 0 0 0; background: transparent;" class="demo-logo"></a>
<span class= smalltext><a href="https://github.com/zoometh/iconr/blob/master/inst/extdata/edges.tsv">https://github.com/zoometh/iconr/blob/master/inst/extdata/edges.tsv</a></span>
</div>

<script src="https://gist.github.com/zoometh/dfa9fb0305961710e28e6d0a05b69eb3.js"></script>

:::


## Functions {auto-animate=true}

```{.r code-line-numbers="1|2|3|4|5|6|7|8"}
dataDir <- system.file("extdata", package = "iconr")
imgs <- read.table(paste0(dataDir, "/imgs.csv"), sep = ";", stringsAsFactors = FALSE)
nodes.shp <- st_read(paste0(dataDir, "/nodes.shp"), quiet = T)
nodes <- as.data.frame(nodes.shp)
edges.shp <- st_read(paste0(dataDir, "/edges.shp"), quiet = T)
edges <- as.data.frame(edges.shp)
lgrph <- list_dec(imgs, nodes, edges)
g <- lgrph[[1]]
plot(g)
```

## Functions {auto-animate=true}

```{r}
#| echo: true

dataDir <- system.file("extdata", package = "iconr")
imgs <- read.table(paste0(dataDir, "/imgs.csv"), sep = ";", stringsAsFactors = FALSE)
nodes.shp <- st_read(paste0(dataDir, "/nodes.shp"), quiet = T)
nodes <- as.data.frame(nodes.shp)
edges.shp <- st_read(paste0(dataDir, "/edges.shp"), quiet = T)
edges <- as.data.frame(edges.shp)
lgrph <- list_dec(imgs, nodes, edges)
g <- lgrph[[1]]
plot(g)
```


## Functions {auto-animate=true}


```{r}
#| echo: true

class(g)
```

## Functions {auto-animate=true}

```{r}
#| echo: true

g$site
```

## Functions {auto-animate=true}

```{r}
#| echo: true

g$decor
```

## Functions {auto-animate=true}

```{r}
#| echo: true

named_elements(g, focus = "edges", nd.var = "type")
```



## Functions {auto-animate=true}

```{r}
#| echo: true
#| warning: false

nodes <- read_nds(g$site, g$decor, dataDir)
edges <- read_eds(g$site, g$decor, dataDir)
plot_dec_grph(nodes = nodes,
              edges = edges,
              imgs = imgs,
              site = g$site, 
              decor = g$decor, 
              dir = dataDir,
              nd.var = "type")
```

## Functions {auto-animate=true}

```{r}
#| echo: true
#| warning: false

nodes <- read_nds(g$site, g$decor, dataDir)
edges <- read_eds(g$site, g$decor, dataDir)
plot_dec_grph(nodes = nodes,
              edges = edges,
              imgs = imgs,
              site = g$site, 
              decor = g$decor, 
              dir = dataDir,
              nd.var = "type",
              nd.size = degree(g)/2,
              lbl.size = 0.1)
```

## Functions {auto-animate=true}

```{r}
#| echo: true
#| warning: false

dec.to.compare <- c(3, 4)
g.compar <- list_compar(lgrph, nd.var = "type")
plot_compar(listg = g.compar, 
            dec2comp = dec.to.compare,
            focus = "nodes",
            nd.size = c(0.5, 1.5),
            dir = dataDir) 
```

## Functions {auto-animate=true}

```{r}
#| echo: true
#| warning: false

dec.to.compare <- c(3, 4)
g.compar <- list_compar(lgrph, nd.var = "type")
plot_compar(listg = g.compar, 
            dec2comp = dec.to.compare,
            focus = "edges",
            nd.size = c(0.5, 1.5),
            dir = dataDir) 
```

## Functions {auto-animate=true}

```{r}
#| echo: true
#| warning: false

df.same_edges <- same_elements(lgrph, nd.var = "type", focus = "edges")
# diag(df.same_edges) <- cell_spec(diag(df.same_edges), color = "black",
#                                  background = "lightgrey")
knitr::kable(df.same_edges, row.names = TRUE, escape = F, table.attr = "style='width:40%;'",
             caption = "Count of common edges between decorations") %>%
  column_spec(1, bold=TRUE) %>%
  kableExtra::kable_styling(position = "center", font_size = 24)
```

## Functions {auto-animate=true}

```{r}
#| echo: true
#| warning: false
#| fig-width: 500

site <- decor <- "Ibahernando"
nds.df <- read_nds(site, decor, dataDir)
eds.df <- read_eds(site, decor, dataDir)
plot_dec_grph(nds.df, eds.df, imgs,
              site, decor, dataDir,
              nd.var = "type")
plot_dec_grph(nds.df, eds.df, imgs,
              site, decor, dataDir)
```
## Functions {auto-animate=true}

```{r}
#| echo: true
#| warning: false
#| fig-width: 500

site <- decor <- "Ibahernando"
nds.df <- read_nds(site, decor, dataDir)
eds.df <- read_eds(site, decor, dataDir)
selected.nd <- 4
l_dec_df <- contemp_nds(nds.df, eds.df, selected.nd)
plot_dec_grph(l_dec_df$nodes, l_dec_df$edges, imgs,
              site, decor, dataDir,
              nd.var = "type")
```

# Study {background-color="aquamarine"}


## Dataset

::: {.panel-tabset}

### Sources

:::: {.columns}

::: {.column width="40%"}

<img src="https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/sources-catalog-diazguardamino.png" width='500px' />

:::

::: {.column width="60%"}

D√≠az-Guardamino Uribe, M. (2010). *Las estelas decoradas en la Prehistoria de la Pen√≠nsula Ib√©rica* (Universidad Complutense de Madrid, Servicio de Publicaciones)<br>
<span class="smalltext">url:  [https://eprints.ucm.es/11070/1/T32200.pdf](https://eprints.ucm.es/11070/1/T32200.pdf)</span>

:::

::::

### Corpus

<img src="https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/stelebouclier/spat_stele_bouclier.png" width='100%' />

:::

## Variables (global) {auto-animate=true}

<img src="https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/stelebouclier/analysis1D/dec_histo/all_graphs_info.png" width='100%' />

## Variables (global) {auto-animate=true}

:::: {.columns}

::: {.column width="50%"}

<img src="https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/stelebouclier/analysis1D/dec_histo/nodes_without_attributes_histo.png" width='500px' />

:::

::: {.column width="50%"}

<img src="https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/stelebouclier/analysis1D/dec_histo/edges_normal_histo.png" width='500px' />

:::

::::

## Variables (global) {auto-animate=true}

:::: {.columns}

::: {.column width="50%"}

<img src="https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/stelebouclier/analysis1D/dec_histo/nodes__attributes_histo.png" width='500px' />

:::

::: {.column width="50%"}

<img src="https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/stelebouclier/analysis1D/dec_histo/edges_attributes_histo.png" width='500px' />

:::

::::

## Variables (local) {auto-animate=true}

:::: {.columns}

::: {.column width="60%"}

<img src="https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/stelebouclier/var/graph.png" width='500px' />

:::

::: {.column width="40%"}

Spatialized graph

:::

::::

## Variables (local) {auto-animate=true}

:::: {.columns}

::: {.column width="60%"}

<img src="https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/stelebouclier/var/typo.png" width='500px' />

:::

::: {.column width="40%"}

Types

:::

::::

## Variables (local) {auto-animate=true}

:::: {.columns}

::: {.column width="60%"}

<img src="https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/stelebouclier/var/long_cm.png" width='500px' />

:::

::: {.column width="40%"}

Maximum length (cm)

:::

::::

## Variables (local) {auto-animate=true}

:::: {.columns}

::: {.column width="60%"}

<img src="https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/stelebouclier/var/orient.png" width='500px' />

:::

::: {.column width="40%"}

Orientation (see [thesaurus](http://shinyserver.cfs.unipi.it:3838/teach/iconr/gu_thes/typo_gu_figuratif.html))

:::

::::

## Variables (local) {auto-animate=true}

:::: {.columns}

::: {.column width="60%"}

<img src="https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/stelebouclier/var/techno.png" width='500px' />

:::

::: {.column width="40%"}

Technology (pecked, incised, painted, etc.)

:::

::::


## Variables (local) {auto-animate=true}

:::: {.columns}

::: {.column width="60%"}

<img src="https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/stelebouclier/var/complet.png" width='500px' />

:::

::: {.column width="40%"}

Completness

:::

::::

## Variables (local) {auto-animate=true}

:::: {.columns}

::: {.column width="60%"}

<img src="https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/stelebouclier/var/betweenness.png" width='500px' />

:::

::: {.column width="40%"}

Betweenness centrality

:::

::::

## Variables (local) {auto-animate=true}

:::: {.columns}

::: {.column width="60%"}

<img src="https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/stelebouclier/var/closeness.png" width='500px' />

:::

::: {.column width="40%"}

Closeness centrality

:::

::::


## Variables (local) {auto-animate=true}

:::: {.columns}

::: {.column width="60%"}

<img src="https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/stelebouclier/var/domition.png" width='500px' />

:::

::: {.column width="40%"}

Domination

:::

::::

## Variables (local) {auto-animate=true}

:::: {.columns}

::: {.column width="60%"}

<img src="https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/stelebouclier/var/chr_1.png" width='500px' />

:::

::: {.column width="40%"}

Cultural attribution

:::

::::

## Variables (local) {auto-animate=true}

:::: {.columns}

::: {.column width="60%"}

<img src="https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/stelebouclier/var/ug_tq.png" width='500px' />

:::

::: {.column width="40%"}

Chronological attribution

:::

::::

## Descriptive statistics - domination

:::{.column-screen-inset}

![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/stelebouclier/analysis1D/ug_n_centralities/ugs_rel_deepness_by_types.png){width=150%}

:::

## Descriptive statistics - lengths


![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/stelebouclier/analysis1D/ug_n_dimensions/ugs_abs_dim_by_types.png)


## Descriptive statistics - orientations

::: {.panel-tabset}

### By stelae (selected types)

![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/stelebouclier/analysis1D/ug_n_orientations/ugs_orient_by_decorations.png)

### By type (selected types)

![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/stelebouclier/analysis1D/ug_n_orientations/ugs_orient_by_types_bouclier.png){width=50%}

![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/stelebouclier/analysis1D/ug_n_orientations/ugs_orient_by_types_epee.png){width=50%}

![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/stelebouclier/analysis1D/ug_n_orientations/ugs_orient_by_types_lance.png){width=50%}

:::

## Exploratory statistics

::: {.panel-tabset}

### Distance matrix

![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/stelebouclier/analysis2D/hmap_common_e_all_decor_with_attributes.png)

### Foios *vs* Ategua

:::: {.columns}

::: {.column width="50%"}

<img src="https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/stelebouclier/var/ex_foios.png" width='500px' />

:::

::: {.column width="50%"}

<img src="https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/stelebouclier/var/ex_ategua.png" width='500px' />

:::

::::

### Clutering

![](https://raw.githubusercontent.com/zoometh/iconr/master/doc/img/stelebouclier/analysis2D/clustering_attributes.png)


:::

# Thank<br>you! {background-color="aquamarine"}


# References


[Other useful R packages: [dplyr]() ...., [knitr]() and [kableExtra]() for HTML/LaTex/PDF/etc. layouts [openxlsx](https://cran.r-project.org/web/packages/openxlsx/index.html) to read/write Excel files, [ggplot2](https://ggplot2.tidyverse.org/) to create plots; [plotly](https://plotly.com/r/)  and [leaflet](https://cran.r-project.org/web/packages/leaflet/index.html) to create interactive plots and maps; etc.]{.aside}

https://hal.archives-ouvertes.fr/hal-02913656/document

The CRAN (Comprehensive R Archive Network) is the official package repository of R, see: https://cran.r-project.org/

https://quarto.org/docs/output-formats/html-basics.html#ref-xie2015



